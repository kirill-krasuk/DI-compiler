{"version":3,"file":"common.js","sources":["../../../src/transformer/constant.ts","../../../src/transformer/before/util.ts","../../../src/transformer/before/visitor/visit-class-like-declaration.ts","../../../src/util/ts-util.ts","../../../src/util/util.ts","../../../src/transformer/before/visitor/visit-call-expression.ts","../../../src/transformer/before/visitor/visit-node.ts","../../../src/transformer/before/before-transformer.ts","../../../src/transformer/after/visitor/visit-root-block.ts","../../../src/transformer/after/visitor/visit-root-block-source-file.ts","../../../src/transformer/after/visitor/visit-root-block-block.ts","../../../src/transformer/after/visitor/visit-define-array-literal-expression.ts","../../../src/transformer/after/visitor/visit-node.ts","../../../src/transformer/after/after-transformer.ts","../../../src/transformer/get-base-visitor-context.ts","../../../src/transformer/di.ts","../../../src/transformer/transform.ts","../../../src/transformer/cache.ts"],"sourcesContent":["export const CONSTRUCTOR_ARGUMENTS_SYMBOL_IDENTIFIER = `___CTOR_ARGS___`;\nexport const DI_CONTAINER_NAME = \"DIContainer\";\n","/* eslint-disable deprecation/deprecation */\nimport type {TS} from \"../../type/type.js\";\nimport type {VisitorContext} from \"../visitor-context.js\";\n\n/**\n * A TypeNode such as IFoo<string> should still yield the service name \"IFoo\".\n * This helper generates a proper service name from a TypeNode\n */\nexport function pickServiceOrImplementationName(node: TS.Expression | TS.TypeNode | TS.EntityName, context: VisitorContext): string {\n\tconst {typescript} = context;\n\n\tif (typescript.isTypeReferenceNode(node)) {\n\t\treturn pickServiceOrImplementationName(node.typeName, context);\n\t} else if (typescript.isIndexedAccessTypeNode(node)) {\n\t\treturn `${pickServiceOrImplementationName(node.objectType, context)}[${pickServiceOrImplementationName(node.indexType, context)}]`;\n\t} else {\n\t\treturn node.getText().trim();\n\t}\n}\n\nexport function getModifierLikes(node: TS.Node): readonly TS.ModifierLike[] | undefined {\n\tconst modifiers = \"modifiers\" in node && Array.isArray(node.modifiers) ? node.modifiers : [];\n\tif (\"decorators\" in node && Array.isArray(node.decorators)) {\n\t\treturn [...node.decorators, ...modifiers];\n\t} else {\n\t\treturn modifiers;\n\t}\n}\n","import {CONSTRUCTOR_ARGUMENTS_SYMBOL_IDENTIFIER} from \"../../constant.js\";\nimport type {TS} from \"../../../type/type.js\";\nimport type {BeforeVisitorOptions} from \"../before-visitor-options.js\";\nimport type {VisitorContext} from \"../../visitor-context.js\";\nimport {getModifierLikes, pickServiceOrImplementationName} from \"../util.js\";\n\nexport function visitClassLikeDeclaration(options: BeforeVisitorOptions<TS.ClassLikeDeclaration>): TS.VisitResult<TS.Node> {\n\tconst {node, childContinuation, continuation, context} = options;\n\tconst {typescript, factory} = context;\n\tconst constructorDeclaration = node.members.find(typescript.isConstructorDeclaration);\n\n\t// If there are no constructor declaration for the ClassLikeDeclaration, there's nothing to do\n\tif (constructorDeclaration == null) {\n\t\treturn childContinuation(node);\n\t}\n\n\tconst updatedClassMembers: readonly TS.ClassElement[] = [\n\t\t...(node.members.map(continuation) as TS.ClassElement[]),\n\t\tfactory.createGetAccessorDeclaration(\n\t\t\t[factory.createModifier(typescript.SyntaxKind.StaticKeyword)],\n\t\t\tfactory.createComputedPropertyName(factory.createIdentifier(`Symbol.for(\"${CONSTRUCTOR_ARGUMENTS_SYMBOL_IDENTIFIER}\")`)),\n\t\t\t[],\n\t\t\tundefined,\n\t\t\tfactory.createBlock([factory.createReturnStatement(getParameterTypeNamesAsArrayLiteral(constructorDeclaration.parameters, context))])\n\t\t)\n\t];\n\n\tconst modifierLikes = getModifierLikes(node);\n\n\tif (typescript.isClassDeclaration(node)) {\n\t\treturn factory.updateClassDeclaration(node, modifierLikes, node.name, node.typeParameters, node.heritageClauses, updatedClassMembers);\n\t} else {\n\t\treturn factory.updateClassExpression(node, modifierLikes, node.name, node.typeParameters, node.heritageClauses, updatedClassMembers);\n\t}\n}\n\n/**\n * Takes ConstructorParams for the given NodeArray of ParameterDeclarations\n */\nfunction getParameterTypeNamesAsArrayLiteral(parameters: TS.NodeArray<TS.ParameterDeclaration>, context: VisitorContext): TS.ArrayLiteralExpression {\n\tconst {factory} = context;\n\tconst constructorParams: TS.Expression[] = [];\n\n\tfor (let i = 0; i < parameters.length; i++) {\n\t\tconst parameter = parameters[i];\n\t\t// If the parameter has no type, there's nothing to extract\n\t\tif (parameter.type == null) {\n\t\t\tconstructorParams[i] = factory.createIdentifier(\"undefined\");\n\t\t} else {\n\t\t\tconstructorParams[i] = factory.createNoSubstitutionTemplateLiteral(pickServiceOrImplementationName(parameter.type, context));\n\t\t}\n\t}\n\n\treturn factory.createArrayLiteralExpression(constructorParams);\n}\n","import {TS} from \"../type/type.js\";\nimport type {ImportedSymbol} from \"../type/imported-symbol.js\";\nimport type {BaseVisitorContext, VisitorContext} from \"../transformer/visitor-context.js\";\nimport type {RootBlock} from \"../type/root-block.js\";\n\ntype TSWithHelpers = typeof TS & {\n\timportDefaultHelper?: TS.EmitHelper;\n\timportStarHelper?: TS.EmitHelper;\n};\n\n// For some TypeScript versions, such as 3.1, these helpers are not exposed by TypeScript,\n// so they will have to be duplicated and reused from here in these rare cases\nconst HELPERS = {\n\timportDefaultHelper: {\n\t\tname: \"typescript:commonjsimportdefault\",\n\t\tscoped: false,\n\t\ttext: '\\nvar __importDefault = (this && this.__importDefault) || function (mod) {\\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\\n};'\n\t},\n\timportStarHelper: {\n\t\tname: \"typescript:commonjsimportstar\",\n\t\tscoped: false,\n\t\ttext: '\\nvar __importStar = (this && this.__importStar) || function (mod) {\\n    if (mod && mod.__esModule) return mod;\\n    var result = {};\\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\\n    result[\"default\"] = mod;\\n    return result;\\n};'\n\t}\n} as const;\n\nexport function needsImportPreservationLogic(context: Pick<BaseVisitorContext, \"compilerOptions\" | \"typescript\">): boolean;\nexport function needsImportPreservationLogic(typescript: typeof TS, compilerOptions: TS.CompilerOptions): boolean;\nexport function needsImportPreservationLogic(\n\ttypescriptOrContext: Pick<BaseVisitorContext, \"compilerOptions\" | \"typescript\"> | typeof TS,\n\tcompilerOptionsOrUndefined?: TS.CompilerOptions\n): boolean {\n\tconst typescript = arguments.length >= 2 ? (typescriptOrContext as typeof TS) : (typescriptOrContext as Pick<BaseVisitorContext, \"compilerOptions\" | \"typescript\">).typescript;\n\tconst compilerOptions = arguments.length >= 2 ? compilerOptionsOrUndefined! : (typescriptOrContext as Pick<BaseVisitorContext, \"compilerOptions\" | \"typescript\">).compilerOptions;\n\n\t// If value imports shouldn't always be preserved, we'll have to perform import preservation logic\n\tif (!Boolean(compilerOptions.preserveValueImports)) return true;\n\n\t// Only TypeScript v4.5 and newer supports the `preserValueImports` Compiler option\n\tif (parseFloat(typescript.version) < 4.5) return true;\n\n\tswitch (compilerOptions.module) {\n\t\tcase typescript.ModuleKind.AMD:\n\t\tcase typescript.ModuleKind.UMD:\n\t\tcase typescript.ModuleKind.CommonJS:\n\t\tcase typescript.ModuleKind.System:\n\t\tcase typescript.ModuleKind.None:\n\t\t\t// None of these module systems support the `preserValueImports` Compiler option\n\t\t\treturn true;\n\t\tdefault:\n\t\t\treturn false;\n\t}\n}\n\nexport function getImportDefaultHelper(typescript: TSWithHelpers): TS.EmitHelper {\n\treturn typescript.importDefaultHelper ?? HELPERS.importDefaultHelper;\n}\n\nexport function getImportStarHelper(typescript: TSWithHelpers): TS.EmitHelper {\n\treturn typescript.importStarHelper ?? HELPERS.importStarHelper;\n}\n\nexport function moduleKindSupportsImportHelpers(moduleKind: TS.ModuleKind = TS.ModuleKind.CommonJS, typescript: typeof TS): boolean {\n\tswitch (moduleKind) {\n\t\tcase typescript.ModuleKind.CommonJS:\n\t\tcase typescript.ModuleKind.UMD:\n\t\tcase typescript.ModuleKind.AMD:\n\t\t\treturn true;\n\t\tdefault:\n\t\t\treturn false;\n\t}\n}\n\nexport function moduleKindDefinesDependencies(moduleKind: TS.ModuleKind = TS.ModuleKind.CommonJS, typescript: typeof TS): boolean {\n\tswitch (moduleKind) {\n\t\tcase typescript.ModuleKind.UMD:\n\t\tcase typescript.ModuleKind.AMD:\n\t\t\treturn true;\n\t\tdefault:\n\t\t\treturn false;\n\t}\n}\n\ninterface EmitHelperFactory {\n\tgetUnscopedHelperName(helperName: string): TS.Identifier;\n}\n\ntype TSWithEmitHelpers = typeof TS &\n\t(\n\t\t| EmitHelperFactory\n\t\t| {\n\t\t\t\tcreateEmitHelperFactory(factory: TS.TransformationContext): EmitHelperFactory;\n\t\t  }\n\t\t| {\n\t\t\t\tgetHelperName(helperName: string): TS.Identifier;\n\t\t  }\n\t);\n\nexport function getUnscopedHelperName(context: VisitorContext, helperName: string): TS.Identifier {\n\tconst typescript = context.typescript as TSWithEmitHelpers;\n\tif (\"getUnscopedHelperName\" in typescript) {\n\t\treturn typescript.getUnscopedHelperName(helperName);\n\t} else if (\"createEmitHelperFactory\" in typescript) {\n\t\treturn typescript.createEmitHelperFactory(context.transformationContext).getUnscopedHelperName(helperName);\n\t} else {\n\t\treturn typescript.getHelperName(helperName);\n\t}\n}\n\nexport function getRootBlockInsertionPosition(rootBlock: RootBlock, typescript: typeof TS): number {\n\tlet insertPosition = 0;\n\n\tfor (let i = 0; i < rootBlock.statements.length; i++) {\n\t\tconst statement = rootBlock.statements[i];\n\n\t\tconst isUseStrict = typescript.isExpressionStatement(statement) && typescript.isStringLiteralLike(statement.expression) && statement.expression.text === \"use strict\";\n\n\t\tconst isEsModuleSymbol =\n\t\t\ttypescript.isExpressionStatement(statement) &&\n\t\t\ttypescript.isCallExpression(statement.expression) &&\n\t\t\ttypescript.isPropertyAccessExpression(statement.expression.expression) &&\n\t\t\ttypescript.isIdentifier(statement.expression.expression.expression) &&\n\t\t\ttypescript.isIdentifier(statement.expression.expression.name) &&\n\t\t\tstatement.expression.expression.expression.text === \"Object\" &&\n\t\t\tstatement.expression.expression.name.text === \"defineProperty\" &&\n\t\t\tstatement.expression.arguments.length >= 2 &&\n\t\t\ttypescript.isIdentifier(statement.expression.arguments[0]) &&\n\t\t\tstatement.expression.arguments[0].text === \"exports\" &&\n\t\t\ttypescript.isStringLiteralLike(statement.expression.arguments[1]) &&\n\t\t\tstatement.expression.arguments[1].text === \"__esModule\";\n\n\t\tif (isUseStrict || isEsModuleSymbol) {\n\t\t\tinsertPosition = Math.max(insertPosition, i + 1);\n\t\t}\n\t}\n\treturn insertPosition;\n}\n\nexport function getDefineArrayLiteralExpression(sourceFile: TS.SourceFile, context: VisitorContext): TS.ArrayLiteralExpression | undefined {\n\tconst {compilerOptions, typescript} = context;\n\n\tswitch (compilerOptions.module) {\n\t\tcase typescript.ModuleKind.ESNext:\n\t\tcase typescript.ModuleKind.ES2015:\n\t\tcase typescript.ModuleKind.ES2020:\n\t\tcase typescript.ModuleKind.ES2022:\n\t\t\t// There are no such thing for these module types\n\t\t\treturn undefined;\n\n\t\t// If we're targeting UMD, the root block won't be the root scope, but the Function Body of an iife\n\t\tcase typescript.ModuleKind.UMD: {\n\t\t\tfor (const statement of sourceFile.statements) {\n\t\t\t\tif (\n\t\t\t\t\ttypescript.isExpressionStatement(statement) &&\n\t\t\t\t\ttypescript.isCallExpression(statement.expression) &&\n\t\t\t\t\ttypescript.isParenthesizedExpression(statement.expression.expression) &&\n\t\t\t\t\ttypescript.isFunctionExpression(statement.expression.expression.expression) &&\n\t\t\t\t\tstatement.expression.expression.expression.parameters.length === 1\n\t\t\t\t) {\n\t\t\t\t\tconst [firstParameter] = statement.expression.expression.expression.parameters;\n\t\t\t\t\tif (typescript.isIdentifier(firstParameter.name)) {\n\t\t\t\t\t\tif (firstParameter.name.text === \"factory\") {\n\t\t\t\t\t\t\tfor (const subStatement of statement.expression.expression.expression.body.statements) {\n\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\ttypescript.isIfStatement(subStatement) &&\n\t\t\t\t\t\t\t\t\tsubStatement.elseStatement != null &&\n\t\t\t\t\t\t\t\t\ttypescript.isIfStatement(subStatement.elseStatement) &&\n\t\t\t\t\t\t\t\t\ttypescript.isBlock(subStatement.elseStatement.thenStatement)\n\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\tfor (const subSubStatement of subStatement.elseStatement.thenStatement.statements) {\n\t\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\t\ttypescript.isExpressionStatement(subSubStatement) &&\n\t\t\t\t\t\t\t\t\t\t\ttypescript.isCallExpression(subSubStatement.expression) &&\n\t\t\t\t\t\t\t\t\t\t\tsubSubStatement.expression.arguments.length === 2 &&\n\t\t\t\t\t\t\t\t\t\t\ttypescript.isIdentifier(subSubStatement.expression.expression) &&\n\t\t\t\t\t\t\t\t\t\t\tsubSubStatement.expression.expression.text === \"define\"\n\t\t\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\t\t\tconst [firstSubSubStatementExpressionArgument] = subSubStatement.expression.arguments;\n\t\t\t\t\t\t\t\t\t\t\tif (typescript.isArrayLiteralExpression(firstSubSubStatementExpressionArgument)) {\n\t\t\t\t\t\t\t\t\t\t\t\treturn firstSubSubStatementExpressionArgument;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\n\t\tcase typescript.ModuleKind.AMD: {\n\t\t\tfor (const statement of sourceFile.statements) {\n\t\t\t\tif (\n\t\t\t\t\ttypescript.isExpressionStatement(statement) &&\n\t\t\t\t\ttypescript.isCallExpression(statement.expression) &&\n\t\t\t\t\ttypescript.isIdentifier(statement.expression.expression) &&\n\t\t\t\t\tstatement.expression.expression.text === \"define\" &&\n\t\t\t\t\tstatement.expression.arguments.length === 2\n\t\t\t\t) {\n\t\t\t\t\tconst [firstArgument, secondArgument] = statement.expression.arguments;\n\t\t\t\t\tif (typescript.isArrayLiteralExpression(firstArgument)) {\n\t\t\t\t\t\tif (typescript.isFunctionExpression(secondArgument) && secondArgument.parameters.length >= 2) {\n\t\t\t\t\t\t\tconst [firstParameter, secondParameter] = secondArgument.parameters;\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\ttypescript.isIdentifier(firstParameter.name) &&\n\t\t\t\t\t\t\t\ttypescript.isIdentifier(secondParameter.name) &&\n\t\t\t\t\t\t\t\tfirstParameter.name.text === \"require\" &&\n\t\t\t\t\t\t\t\tsecondParameter.name.text === \"exports\"\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\treturn firstArgument;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn undefined;\n}\n\nexport function getRootBlock(sourceFile: TS.SourceFile, context: VisitorContext): RootBlock {\n\tconst {compilerOptions, typescript} = context;\n\n\tswitch (compilerOptions.module) {\n\t\t// If we're targeting UMD, the root block won't be the root scope, but the Function Body of an iife\n\t\tcase typescript.ModuleKind.UMD: {\n\t\t\tfor (const statement of sourceFile.statements) {\n\t\t\t\tif (typescript.isExpressionStatement(statement) && typescript.isCallExpression(statement.expression) && statement.expression.arguments.length === 1) {\n\t\t\t\t\tconst [firstArgument] = statement.expression.arguments;\n\t\t\t\t\tif (typescript.isFunctionExpression(firstArgument) && firstArgument.parameters.length === 2) {\n\t\t\t\t\t\tconst [firstParameter, secondParameter] = firstArgument.parameters;\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\ttypescript.isIdentifier(firstParameter.name) &&\n\t\t\t\t\t\t\ttypescript.isIdentifier(secondParameter.name) &&\n\t\t\t\t\t\t\tfirstParameter.name.text === \"require\" &&\n\t\t\t\t\t\t\tsecondParameter.name.text === \"exports\"\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\treturn firstArgument.body;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\n\t\t// If we're targeting AMD, the root block won't be the root scope, but the Function Body of the\n\t\t// anonymous function provided as a second argument to the define() function\n\t\tcase typescript.ModuleKind.AMD: {\n\t\t\tfor (const statement of sourceFile.statements) {\n\t\t\t\tif (\n\t\t\t\t\ttypescript.isExpressionStatement(statement) &&\n\t\t\t\t\ttypescript.isCallExpression(statement.expression) &&\n\t\t\t\t\ttypescript.isIdentifier(statement.expression.expression) &&\n\t\t\t\t\tstatement.expression.expression.text === \"define\" &&\n\t\t\t\t\tstatement.expression.arguments.length === 2\n\t\t\t\t) {\n\t\t\t\t\tconst [, secondArgument] = statement.expression.arguments;\n\t\t\t\t\tif (typescript.isFunctionExpression(secondArgument) && secondArgument.parameters.length >= 2) {\n\t\t\t\t\t\tconst [firstParameter, secondParameter] = secondArgument.parameters;\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\ttypescript.isIdentifier(firstParameter.name) &&\n\t\t\t\t\t\t\ttypescript.isIdentifier(secondParameter.name) &&\n\t\t\t\t\t\t\tfirstParameter.name.text === \"require\" &&\n\t\t\t\t\t\t\tsecondParameter.name.text === \"exports\"\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\treturn secondArgument.body;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn sourceFile;\n}\n\nexport function isImportedSymbolImported(importedSymbol: ImportedSymbol, rootBlock: RootBlock, context: VisitorContext): boolean {\n\tconst {compilerOptions, typescript} = context;\n\n\tswitch (compilerOptions.module) {\n\t\tcase typescript.ModuleKind.ES2022:\n\t\tcase typescript.ModuleKind.ES2020:\n\t\tcase typescript.ModuleKind.ES2015:\n\t\tcase typescript.ModuleKind.ESNext: {\n\t\t\tfor (const statement of rootBlock.statements) {\n\t\t\t\tif (!typescript.isImportDeclaration(statement)) continue;\n\t\t\t\tif (!typescript.isStringLiteralLike(statement.moduleSpecifier)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif (statement.moduleSpecifier.text !== importedSymbol.moduleSpecifier) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif (statement.importClause == null) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (\"isDefaultImport\" in importedSymbol) {\n\t\t\t\t\tif (importedSymbol.isDefaultImport) {\n\t\t\t\t\t\tif (statement.importClause.name == null) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (statement.importClause.name.text !== importedSymbol.name) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (statement.importClause.namedBindings == null) continue;\n\t\t\t\t\t\tif (!typescript.isNamedImports(statement.importClause.namedBindings)) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (const importSpecifier of statement.importClause.namedBindings.elements) {\n\t\t\t\t\t\t\tif (importSpecifier.name.text !== importedSymbol.name) continue;\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if (\"isNamespaceImport\" in importedSymbol) {\n\t\t\t\t\tif (statement.importClause.namedBindings == null) continue;\n\t\t\t\t\tif (!typescript.isNamespaceImport(statement.importClause.namedBindings)) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tif (statement.importClause.namedBindings.name.text !== importedSymbol.name) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn false;\n\t\t}\n\n\t\tcase typescript.ModuleKind.CommonJS:\n\t\tcase typescript.ModuleKind.AMD:\n\t\tcase typescript.ModuleKind.UMD: {\n\t\t\tfor (const statement of rootBlock.statements) {\n\t\t\t\tif (!typescript.isVariableStatement(statement)) continue;\n\t\t\t\tfor (const declaration of statement.declarationList.declarations) {\n\t\t\t\t\tif (!typescript.isIdentifier(declaration.name)) continue;\n\t\t\t\t\tif (declaration.name.text !== importedSymbol.name) continue;\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// TODO: Add support for other module systems\n\treturn false;\n}\n\nexport function generateImportStatementForImportedSymbolInContext(importedSymbol: ImportedSymbol, context: VisitorContext): TS.Statement | undefined {\n\tconst {compilerOptions, typescript, factory} = context;\n\n\tswitch (compilerOptions.module) {\n\t\tcase typescript.ModuleKind.ES2022:\n\t\tcase typescript.ModuleKind.ES2020:\n\t\tcase typescript.ModuleKind.ES2015:\n\t\tcase typescript.ModuleKind.ESNext: {\n\t\t\treturn factory.createImportDeclaration(\n\t\t\t\tundefined,\n\t\t\t\t\"isDefaultImport\" in importedSymbol\n\t\t\t\t\t? factory.createImportClause(\n\t\t\t\t\t\t\tfalse,\n\t\t\t\t\t\t\t!importedSymbol.isDefaultImport ? undefined : factory.createIdentifier(importedSymbol.name),\n\t\t\t\t\t\t\timportedSymbol.isDefaultImport\n\t\t\t\t\t\t\t\t? undefined\n\t\t\t\t\t\t\t\t: factory.createNamedImports([\n\t\t\t\t\t\t\t\t\t\tfactory.createImportSpecifier(\n\t\t\t\t\t\t\t\t\t\t\tfalse,\n\t\t\t\t\t\t\t\t\t\t\timportedSymbol.propertyName === importedSymbol.name ? undefined : factory.createIdentifier(importedSymbol.propertyName),\n\t\t\t\t\t\t\t\t\t\t\tfactory.createIdentifier(importedSymbol.name)\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t  ])\n\t\t\t\t\t  )\n\t\t\t\t\t: \"isNamespaceImport\" in importedSymbol\n\t\t\t\t\t? factory.createImportClause(false, undefined, factory.createNamespaceImport(factory.createIdentifier(importedSymbol.name)))\n\t\t\t\t\t: undefined,\n\t\t\t\tfactory.createStringLiteral(importedSymbol.moduleSpecifier)\n\t\t\t);\n\t\t}\n\n\t\tcase typescript.ModuleKind.CommonJS:\n\t\tcase typescript.ModuleKind.AMD:\n\t\tcase typescript.ModuleKind.UMD: {\n\t\t\tconst requireCall = factory.createCallExpression(factory.createIdentifier(\"require\"), undefined, [factory.createStringLiteral(importedSymbol.moduleSpecifier)]);\n\n\t\t\tlet wrappedRequireCall = requireCall;\n\n\t\t\t// We'll need to use a helper, '__importDefault', and wrap the require call with it\n\t\t\tif (\n\t\t\t\tcompilerOptions.esModuleInterop === true &&\n\t\t\t\t((\"isDefaultImport\" in importedSymbol && importedSymbol.isDefaultImport) || (!(\"isDefaultImport\" in importedSymbol) && importedSymbol.isNamespaceImport))\n\t\t\t) {\n\t\t\t\t// If tslib is being used, we can do something like 'require(\"tslib\").__import{Default|Star}(<requireCall>)'\n\t\t\t\tif (compilerOptions.importHelpers === true) {\n\t\t\t\t\twrappedRequireCall = factory.createCallExpression(\n\t\t\t\t\t\tfactory.createPropertyAccessExpression(\n\t\t\t\t\t\t\tfactory.createCallExpression(factory.createIdentifier(\"require\"), undefined, [factory.createStringLiteral(\"tslib\")]),\n\t\t\t\t\t\t\tgetUnscopedHelperName(context, \"isDefaultImport\" in importedSymbol ? \"__importDefault\" : \"__importStar\")\n\t\t\t\t\t\t),\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t[requireCall]\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\t// Otherwise, we'll have to make sure that the helper is being inlined in an transformation step later\n\t\t\t\telse {\n\t\t\t\t\t// We've already requested the __importDefault helper in the before transformer under these\n\t\t\t\t\t// circumstances\n\t\t\t\t\twrappedRequireCall = factory.createCallExpression(getUnscopedHelperName(context, \"isDefaultImport\" in importedSymbol ? \"__importDefault\" : \"__importStar\"), undefined, [\n\t\t\t\t\t\trequireCall\n\t\t\t\t\t]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn factory.createVariableStatement(\n\t\t\t\tundefined,\n\t\t\t\tfactory.createVariableDeclarationList(\n\t\t\t\t\t[factory.createVariableDeclaration(factory.createIdentifier(importedSymbol.name), undefined, undefined, wrappedRequireCall)],\n\t\t\t\t\ttypescript.NodeFlags.Const\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t}\n\n\t// TODO: Handle other module types as well\n\treturn undefined;\n}\n","import type {Nullable} from \"helpertypes\";\nimport crypto from \"crypto\";\n\n/**\n * Ensures that the given item is an array\n */\nexport function ensureArray<T>(item: T[] | T): T[] {\n\treturn Array.isArray(item) ? item : [item];\n}\n\n/**\n * Converts the given string to a boolean\n */\nexport function booleanize(str: string | boolean | undefined): boolean {\n\tif (str == null) return false;\n\tif (typeof str === \"boolean\") return str;\n\n\tif (isTrueLike(str)) {\n\t\treturn true;\n\t} else if (isFalseLike(str)) {\n\t\treturn false;\n\t} else {\n\t\treturn Boolean(str);\n\t}\n}\n\nexport function isTrueLike(str: Nullable<string | boolean>): boolean {\n\tif (typeof str === \"boolean\") return str === true;\n\tif (str == null) return false;\n\n\tswitch (str.toLowerCase().trim()) {\n\t\tcase \"true\":\n\t\tcase \"yes\":\n\t\tcase \"1\":\n\t\tcase \"\":\n\t\t\treturn true;\n\n\t\tdefault:\n\t\t\treturn false;\n\t}\n}\n\nexport function isFalseLike(str: Nullable<string | boolean>): boolean {\n\tif (typeof str === \"boolean\") return str === false;\n\tif (str == null) return true;\n\n\tswitch (str.toLowerCase().trim()) {\n\t\tcase \"false\":\n\t\tcase \"no\":\n\t\tcase \"0\":\n\t\t\treturn true;\n\n\t\tdefault:\n\t\t\treturn false;\n\t}\n}\n\nexport const sha1 = (data: string) => crypto.createHash(\"sha1\").update(data).digest(\"hex\");\nexport const NOOP = () => {\n\t// Noop\n};\n","import {DI_CONTAINER_NAME} from \"../../constant.js\";\nimport type {TS} from \"../../../type/type.js\";\nimport type {BeforeVisitorOptions} from \"../before-visitor-options.js\";\nimport type {DiMethodName} from \"../../di-method-kind.js\";\nimport type {VisitorContext} from \"../../visitor-context.js\";\nimport {getImportDefaultHelper, getImportStarHelper, moduleKindDefinesDependencies, moduleKindSupportsImportHelpers} from \"../../../util/ts-util.js\";\nimport {pickServiceOrImplementationName} from \"../util.js\";\nimport {ensureArray} from \"../../../util/util.js\";\n\nexport function visitCallExpression(options: BeforeVisitorOptions<TS.CallExpression>): TS.VisitResult<TS.Node> {\n\tconst {node, childContinuation, continuation, context, addTslibDefinition, requireImportedSymbol} = options;\n\tconst {typescript, factory, compilerOptions, transformationContext, needsImportPreservationLogic} = context;\n\n\tconst diMethod = getDiMethodName(node.expression, context);\n\n\tif (diMethod != null) {\n\t\tswitch (diMethod) {\n\t\t\tcase \"get\":\n\t\t\tcase \"has\": {\n\t\t\t\t// If no type arguments are given, don't modify the node at all\n\t\t\t\tif (node.typeArguments == null || node.typeArguments[0] == null) {\n\t\t\t\t\treturn childContinuation(node);\n\t\t\t\t}\n\n\t\t\t\tconst [firstTypeArgument] = node.typeArguments;\n\n\t\t\t\treturn factory.updateCallExpression(node, node.expression, node.typeArguments, [\n\t\t\t\t\tfactory.createObjectLiteralExpression([\n\t\t\t\t\t\tfactory.createPropertyAssignment(\"identifier\", factory.createStringLiteral((firstTypeArgument.getFirstToken()?.getText() ?? firstTypeArgument.getText()).trim()))\n\t\t\t\t\t])\n\t\t\t\t]);\n\t\t\t}\n\n\t\t\tcase \"registerSingleton\":\n\t\t\tcase \"registerTransient\": {\n\t\t\t\tconst [typeArg, secondTypeArg] = (node.typeArguments ?? []) as unknown as [TS.TypeNode | undefined, TS.TypeNode | TS.Expression | undefined];\n\t\t\t\tconst [firstArgument] = node.arguments ?? [];\n\n\t\t\t\t// The user may explicitly pass 'undefined' as a value here, which shouldn't count as a custom implementation\n\t\t\t\tconst customImplementation = firstArgument == null || (typescript.isIdentifier(firstArgument) && firstArgument.text === \"undefined\") ? undefined : firstArgument;\n\n\t\t\t\tconst implementationArg =\n\t\t\t\t\t// If another implementation is passed, used that one instead\n\t\t\t\t\tcustomImplementation ??\n\t\t\t\t\t// If not implementation is provided, use the type argument *as* the implementation\n\t\t\t\t\tsecondTypeArg ??\n\t\t\t\t\ttypeArg;\n\n\t\t\t\tif (typeArg == null || implementationArg == null) {\n\t\t\t\t\treturn childContinuation(node);\n\t\t\t\t}\n\n\t\t\t\tconst typeArgText = pickServiceOrImplementationName(typeArg, context);\n\t\t\t\tconst implementationArgText = pickServiceOrImplementationName(implementationArg, context);\n\n\t\t\t\t// If the Implementation is a TypeNode, and if it originates from an ImportDeclaration, it may be stripped from the file since Typescript won't Type-check the updates from\n\t\t\t\t// a CustomTransformer and such a node would normally be removed from the imports.\n\t\t\t\t// to fix it, add an ImportDeclaration if needed. This is only needed if `preserveValueImports` is falsy\n\t\t\t\tif (needsImportPreservationLogic && customImplementation == null) {\n\t\t\t\t\tconst matchingImport = findMatchingImportDeclarationForIdentifier(implementationArgText, options);\n\t\t\t\t\tif (matchingImport != null && typescript.isStringLiteralLike(matchingImport.importDeclaration.moduleSpecifier)) {\n\t\t\t\t\t\tswitch (matchingImport.kind) {\n\t\t\t\t\t\t\tcase \"default\": {\n\t\t\t\t\t\t\t\t// Log a request for the __importDefault helper already if we will\n\t\t\t\t\t\t\t\t// need it in a later transformation step\n\t\t\t\t\t\t\t\tif (moduleKindSupportsImportHelpers(compilerOptions.module, typescript) && compilerOptions.esModuleInterop === true && compilerOptions.importHelpers !== true) {\n\t\t\t\t\t\t\t\t\ttransformationContext.requestEmitHelper(getImportDefaultHelper(typescript));\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t// Log a request for adding 'tslib' to the define([...]) array for the current\n\t\t\t\t\t\t\t\t// module system if it relies on declaring dependencies (such as UMD, AMD, and SystemJS does)\n\t\t\t\t\t\t\t\tif (moduleKindDefinesDependencies(compilerOptions.module, typescript) && compilerOptions.esModuleInterop === true && compilerOptions.importHelpers === true) {\n\t\t\t\t\t\t\t\t\taddTslibDefinition();\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\trequireImportedSymbol({\n\t\t\t\t\t\t\t\t\tisDefaultImport: true,\n\t\t\t\t\t\t\t\t\tmoduleSpecifier: matchingImport.importDeclaration.moduleSpecifier.text,\n\t\t\t\t\t\t\t\t\tname: matchingImport.identifier.text,\n\t\t\t\t\t\t\t\t\tpropertyName: matchingImport.identifier.text\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tcase \"namedImport\": {\n\t\t\t\t\t\t\t\trequireImportedSymbol({\n\t\t\t\t\t\t\t\t\tisDefaultImport: false,\n\t\t\t\t\t\t\t\t\tmoduleSpecifier: matchingImport.importDeclaration.moduleSpecifier.text,\n\t\t\t\t\t\t\t\t\tname: matchingImport.importSpecifier.name.text,\n\t\t\t\t\t\t\t\t\tpropertyName: matchingImport.importSpecifier.propertyName?.text ?? matchingImport.importSpecifier.name.text\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tcase \"namespace\": {\n\t\t\t\t\t\t\t\t// Log a request for the __importStar helper already if you will\n\t\t\t\t\t\t\t\t// need it in a later transformation step\n\t\t\t\t\t\t\t\tif (moduleKindSupportsImportHelpers(compilerOptions.module, typescript) && compilerOptions.esModuleInterop === true && compilerOptions.importHelpers !== true) {\n\t\t\t\t\t\t\t\t\ttransformationContext.requestEmitHelper(getImportStarHelper(typescript));\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\trequireImportedSymbol({\n\t\t\t\t\t\t\t\t\tisNamespaceImport: true,\n\t\t\t\t\t\t\t\t\tmoduleSpecifier: matchingImport.importDeclaration.moduleSpecifier.text,\n\t\t\t\t\t\t\t\t\tname: matchingImport.identifier.text\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn factory.updateCallExpression(node, node.expression, node.typeArguments, [\n\t\t\t\t\tcustomImplementation == null ? factory.createIdentifier(\"undefined\") : (continuation(implementationArg) as TS.Expression),\n\t\t\t\t\tfactory.createObjectLiteralExpression([\n\t\t\t\t\t\tfactory.createPropertyAssignment(\"identifier\", factory.createNoSubstitutionTemplateLiteral(typeArgText)),\n\t\t\t\t\t\t...(customImplementation != null\n\t\t\t\t\t\t\t? []\n\t\t\t\t\t\t\t: [factory.createPropertyAssignment(\"implementation\", factory.createIdentifier(rewriteImplementationName(implementationArgText, options)))])\n\t\t\t\t\t])\n\t\t\t\t]);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn childContinuation(node);\n}\n\ninterface FindMatchingImportDeclarationForIdentifierBaseResult {\n\tkind: \"default\" | \"namespace\" | \"namedImport\";\n\timportDeclaration: TS.ImportDeclaration;\n}\n\ninterface FindMatchingImportDeclarationForIdentifierNamedImportResult extends FindMatchingImportDeclarationForIdentifierBaseResult {\n\tkind: \"namedImport\";\n\timportSpecifier: TS.ImportSpecifier;\n}\n\ninterface FindMatchingImportDeclarationForIdentifierDefaultResult extends FindMatchingImportDeclarationForIdentifierBaseResult {\n\tkind: \"default\";\n\tidentifier: TS.Identifier;\n}\n\ninterface FindMatchingImportDeclarationForIdentifierNamespaceResult extends FindMatchingImportDeclarationForIdentifierBaseResult {\n\tkind: \"namespace\";\n\tidentifier: TS.Identifier;\n}\n\ntype FindMatchingImportDeclarationForIdentifierResult =\n\t| FindMatchingImportDeclarationForIdentifierNamedImportResult\n\t| FindMatchingImportDeclarationForIdentifierDefaultResult\n\t| FindMatchingImportDeclarationForIdentifierNamespaceResult;\n\nfunction findMatchingImportDeclarationForIdentifier(\n\tidentifier: string,\n\toptions: BeforeVisitorOptions<TS.CallExpression>\n): FindMatchingImportDeclarationForIdentifierResult | undefined {\n\tconst {\n\t\tsourceFile,\n\t\tcontext: {typescript}\n\t} = options;\n\n\t// Find the matching import\n\tconst importDeclarations = sourceFile.statements.filter(typescript.isImportDeclaration);\n\n\tfor (const importDeclaration of importDeclarations) {\n\t\tif (importDeclaration.importClause == null) continue;\n\n\t\t// Default import\n\t\tif (importDeclaration.importClause.name?.text === identifier) {\n\t\t\treturn {\n\t\t\t\timportDeclaration,\n\t\t\t\tkind: \"default\",\n\t\t\t\tidentifier: importDeclaration.importClause.name\n\t\t\t};\n\t\t} else if (importDeclaration.importClause.namedBindings != null) {\n\t\t\tif (typescript.isNamespaceImport(importDeclaration.importClause.namedBindings)) {\n\t\t\t\tif (importDeclaration.importClause.namedBindings.name.text === identifier) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\timportDeclaration,\n\t\t\t\t\t\tkind: \"namespace\",\n\t\t\t\t\t\tidentifier: importDeclaration.importClause.namedBindings.name\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor (const importSpecifier of importDeclaration.importClause.namedBindings.elements) {\n\t\t\t\t\tif (importSpecifier.name.text === identifier) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\timportDeclaration,\n\t\t\t\t\t\t\tkind: \"namedImport\",\n\t\t\t\t\t\t\timportSpecifier: importSpecifier\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// No import was matched\n\treturn undefined;\n}\n\nfunction rewriteImplementationName(name: string, options: BeforeVisitorOptions<TS.CallExpression>): string {\n\tconst {\n\t\tcontext: {typescript, compilerOptions}\n\t} = options;\n\n\tswitch (compilerOptions.module) {\n\t\tcase typescript.ModuleKind.ES2022:\n\t\tcase typescript.ModuleKind.ES2020:\n\t\tcase typescript.ModuleKind.ES2015:\n\t\tcase typescript.ModuleKind.ESNext:\n\t\t\treturn name;\n\n\t\tcase typescript.ModuleKind.CommonJS:\n\t\tcase typescript.ModuleKind.AMD:\n\t\tcase typescript.ModuleKind.UMD: {\n\t\t\t// Find the matching import\n\t\t\tconst match = findMatchingImportDeclarationForIdentifier(name, options);\n\t\t\tif (match == null) {\n\t\t\t\treturn name;\n\t\t\t}\n\n\t\t\tswitch (match.kind) {\n\t\t\t\tcase \"default\":\n\t\t\t\t\treturn `${name}.default`;\n\t\t\t\tcase \"namespace\":\n\t\t\t\t\treturn name;\n\t\t\t\tcase \"namedImport\":\n\t\t\t\t\treturn `${name}.${(match.importSpecifier.propertyName ?? match.importSpecifier.name).text}`;\n\t\t\t}\n\n\t\t\t// Fall back to returning the original name\n\t\t\treturn name;\n\t\t}\n\n\t\tdefault:\n\t\t\t// TODO: Add support for SystemJS here\n\t\t\treturn name;\n\t}\n}\n\nfunction getDiMethodName(node: TS.Expression, context: VisitorContext): DiMethodName | undefined {\n\tif (!context.typescript.isPropertyAccessExpression(node) && !context.typescript.isElementAccessExpression(node)) {\n\t\treturn undefined;\n\t}\n\n\t// If it is an element access expression, evaluate the argument expression\n\tif (context.typescript.isElementAccessExpression(node)) {\n\t\t// Do nothing at this point if this isn't a DIContainer instance, as we can avoid invoking evaluate at this point\n\t\tif (!isDiContainerInstance(node, context)) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst evaluationResult = context.evaluate(node.argumentExpression);\n\n\t\t// If no value could be computed, or if the value isn't of type string, do nothing\n\t\tif (!evaluationResult.success || typeof evaluationResult.value !== \"string\") {\n\t\t\treturn undefined;\n\t\t} else {\n\t\t\treturn isDiContainerMethodName(evaluationResult.value) ? evaluationResult.value : undefined;\n\t\t}\n\t} else {\n\t\t// If the name is any of the relevant ones, assert that it is invoked on an instance of DIContainer\n\t\treturn isDiContainerMethodName(node.name.text) && isDiContainerInstance(node, context) ? node.name.text : undefined;\n\t}\n}\n\nfunction isDiContainerMethodName(name: string): name is DiMethodName {\n\tswitch (name) {\n\t\tcase \"get\":\n\t\tcase \"has\":\n\t\tcase \"registerSingleton\":\n\t\tcase \"registerTransient\":\n\t\t\treturn true;\n\t\tdefault:\n\t\t\treturn false;\n\t}\n}\n\nfunction isDiContainerInstance(node: TS.PropertyAccessExpression | TS.ElementAccessExpression, context: VisitorContext): boolean {\n\tif (\"typeChecker\" in context) {\n\t\t// Don't proceed unless the left-hand expression is the DIServiceContainer\n\t\tconst type = context.typeChecker.getTypeAtLocation(node.expression);\n\n\t\tif (type == null || type.symbol == null || type.symbol.escapedName !== DI_CONTAINER_NAME) {\n\t\t\treturn false;\n\t\t}\n\t} else {\n\t\t// If one or more variable names were passed in, check those directly\n\t\tif (context.identifier != null && context.identifier.length > 0) {\n\t\t\t// Pick the left-hand side of the expression here\n\t\t\tconst name = (node.expression.getFirstToken()?.getText() ?? node.expression.getText()).trim();\n\t\t\t// If not a single matcher matches the text, this does not represent an instance of DIContainer.\n\t\t\tif (!ensureArray(context.identifier).some(matcher => name === matcher)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t} else {\n\t\t\t// Otherwise, attempt to resolve the value of the expression and check if it is an instance of DIContainer\n\t\t\tconst evaluationResult = context.evaluate(node.expression);\n\n\t\t\tif (\n\t\t\t\t!evaluationResult.success ||\n\t\t\t\tevaluationResult.value == null ||\n\t\t\t\ttypeof evaluationResult.value !== \"object\" ||\n\t\t\t\tevaluationResult.value.constructor?.name !== DI_CONTAINER_NAME\n\t\t\t) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t}\n\treturn true;\n}\n","import type {BeforeVisitorOptions} from \"../before-visitor-options.js\";\nimport type {TS} from \"../../../type/type.js\";\nimport {visitClassLikeDeclaration} from \"./visit-class-like-declaration.js\";\nimport {visitCallExpression} from \"./visit-call-expression.js\";\n\nexport function visitNode<T extends TS.Node>(options: BeforeVisitorOptions<T>): TS.VisitResult<TS.Node> {\n\tif (options.context.typescript.isClassLike(options.node)) {\n\t\treturn visitClassLikeDeclaration({...options, node: options.node});\n\t} else if (options.context.typescript.isCallExpression(options.node)) {\n\t\treturn visitCallExpression({...options, node: options.node});\n\t}\n\n\treturn options.childContinuation(options.node);\n}\n","import type {BaseVisitorContext, VisitorContext} from \"../visitor-context.js\";\nimport type {TS} from \"../../type/type.js\";\nimport type {BeforeVisitorOptions} from \"./before-visitor-options.js\";\nimport {visitNode} from \"./visitor/visit-node.js\";\nimport type {ImportedSymbol} from \"../../type/imported-symbol.js\";\nimport {ensureNodeFactory} from \"compatfactory\";\n\nexport function beforeTransformer(context: BaseVisitorContext): TS.TransformerFactory<TS.SourceFile> {\n\treturn transformationContext => {\n\t\tconst factory = ensureNodeFactory(transformationContext.factory ?? context.typescript);\n\n\t\treturn sourceFile =>\n\t\t\ttransformSourceFile(sourceFile, {\n\t\t\t\t...context,\n\t\t\t\ttransformationContext,\n\t\t\t\tfactory\n\t\t\t});\n\t};\n}\n\nexport function transformSourceFile(sourceFile: TS.SourceFile, context: VisitorContext): TS.SourceFile {\n\tconst requiredImportedSymbolSet = new Set<ImportedSymbol>();\n\n\t/**\n\t * An optimization in which every imported symbol is converted into\n\t * a string that can be matched against directly to guard against\n\t * duplicates\n\t */\n\tconst requiredImportedSymbolSetFlags = new Set<string>();\n\n\tif (context.needsImportPreservationLogic) {\n\t\tcontext.sourceFileToAddTslibDefinition.set(sourceFile.fileName, false);\n\t\tcontext.sourceFileToRequiredImportedSymbolSet.set(sourceFile.fileName, requiredImportedSymbolSet);\n\t}\n\n\tconst computeImportedSymbolFlag = (symbol: ImportedSymbol): string =>\n\t\t[\"name\", \"propertyName\", \"moduleSpecifier\", \"isNamespaceImport\", \"isDefaultImport\"]\n\t\t\t.map(property => `${property}:${symbol[property as keyof ImportedSymbol] ?? false}`)\n\t\t\t.join(\"|\");\n\n\tconst visitorOptions: Omit<BeforeVisitorOptions<TS.Node>, \"node\" | \"sourceFile\"> = {\n\t\tcontext,\n\n\t\taddTslibDefinition: (): void => {\n\t\t\tif (!context.needsImportPreservationLogic) return;\n\t\t\tcontext.sourceFileToAddTslibDefinition.set(sourceFile.fileName, true);\n\t\t},\n\n\t\trequireImportedSymbol: (importedSymbol: ImportedSymbol): void => {\n\t\t\tif (!context.needsImportPreservationLogic) return;\n\n\t\t\t// Guard against duplicates and compute a string so we can do\n\t\t\t// constant time lookups to compare against existing symbols\n\t\t\tconst flag = computeImportedSymbolFlag(importedSymbol);\n\t\t\tif (requiredImportedSymbolSetFlags.has(flag)) return;\n\t\t\trequiredImportedSymbolSetFlags.add(flag);\n\n\t\t\trequiredImportedSymbolSet.add(importedSymbol);\n\t\t},\n\n\t\tcontinuation: node =>\n\t\t\tvisitNode({\n\t\t\t\t...visitorOptions,\n\t\t\t\tsourceFile,\n\t\t\t\tnode\n\t\t\t}),\n\t\tchildContinuation: node =>\n\t\t\tcontext.typescript.visitEachChild(\n\t\t\t\tnode,\n\t\t\t\tcbNode =>\n\t\t\t\t\tvisitNode({\n\t\t\t\t\t\t...visitorOptions,\n\t\t\t\t\t\tsourceFile,\n\t\t\t\t\t\tnode: cbNode\n\t\t\t\t\t}),\n\t\t\t\tcontext.transformationContext\n\t\t\t)\n\t};\n\n\treturn visitorOptions.continuation(sourceFile) as TS.SourceFile;\n}\n","import type {TS} from \"../../../type/type.js\";\nimport type {AfterVisitorOptions} from \"../after-visitor-options.js\";\nimport {generateImportStatementForImportedSymbolInContext, getRootBlockInsertionPosition, isImportedSymbolImported} from \"../../../util/ts-util.js\";\nimport type {RootBlock} from \"../../../type/root-block.js\";\n\nexport function visitRootBlock(options: AfterVisitorOptions<RootBlock>): TS.Statement[] {\n\tconst {node, sourceFile, context} = options;\n\tconst {typescript} = context;\n\n\tconst leadingExtraStatements: TS.Statement[] = [];\n\n\tfor (const importedSymbol of context.sourceFileToRequiredImportedSymbolSet.get(sourceFile.fileName) ?? new Set()) {\n\t\tif (isImportedSymbolImported(importedSymbol, node, context)) continue;\n\n\t\tconst missingImportStatement = generateImportStatementForImportedSymbolInContext(importedSymbol, context);\n\n\t\tif (missingImportStatement != null) {\n\t\t\tleadingExtraStatements.push(missingImportStatement);\n\t\t}\n\t}\n\n\tconst insertPosition = getRootBlockInsertionPosition(node, typescript);\n\n\treturn [...node.statements.slice(0, insertPosition), ...leadingExtraStatements, ...node.statements.slice(insertPosition)];\n}\n","import type {TS} from \"../../../type/type.js\";\nimport type {AfterVisitorOptions} from \"../after-visitor-options.js\";\nimport {visitRootBlock} from \"./visit-root-block.js\";\n\nexport function visitRootBlockSourceFile(options: AfterVisitorOptions<TS.SourceFile>): TS.VisitResult<TS.Node> {\n\tconst {node, context} = options;\n\tconst {factory} = context;\n\n\treturn factory.updateSourceFile(\n\t\tnode,\n\t\tvisitRootBlock(options),\n\t\tnode.isDeclarationFile,\n\t\tnode.referencedFiles,\n\t\tnode.typeReferenceDirectives,\n\t\tnode.hasNoDefaultLib,\n\t\tnode.libReferenceDirectives\n\t);\n}\n","import type {TS} from \"../../../type/type.js\";\nimport type {AfterVisitorOptions} from \"../after-visitor-options.js\";\nimport {visitRootBlock} from \"./visit-root-block.js\";\n\nexport function visitRootBlockBlock(options: AfterVisitorOptions<TS.Block>): TS.VisitResult<TS.Node> {\n\tconst {node, context} = options;\n\tconst {factory} = context;\n\n\treturn factory.updateBlock(node, visitRootBlock(options));\n}\n","import type {TS} from \"../../../type/type.js\";\nimport type {AfterVisitorOptions} from \"../after-visitor-options.js\";\n\nexport function visitDefineArrayLiteralExpression(options: AfterVisitorOptions<TS.ArrayLiteralExpression>): TS.ArrayLiteralExpression {\n\tconst {node, sourceFile, context} = options;\n\tconst {typescript, factory} = context;\n\n\tconst trailingExtraExpressions: TS.Expression[] = [];\n\n\tfor (const importedSymbol of context.sourceFileToRequiredImportedSymbolSet.get(sourceFile.fileName) ?? new Set()) {\n\t\t// Skip the node if it is already declared as a dependency\n\t\tif (node.elements.some(element => typescript.isStringLiteralLike(element) && element.text === importedSymbol.moduleSpecifier)) {\n\t\t\tcontinue;\n\t\t}\n\n\t\ttrailingExtraExpressions.push(factory.createStringLiteral(importedSymbol.moduleSpecifier));\n\t}\n\n\tif (context.sourceFileToAddTslibDefinition.get(sourceFile.fileName) === true) {\n\t\ttrailingExtraExpressions.push(factory.createStringLiteral(\"tslib\"));\n\t}\n\n\tif (trailingExtraExpressions.length < 1) {\n\t\treturn node;\n\t}\n\n\treturn factory.updateArrayLiteralExpression(node, [...node.elements, ...trailingExtraExpressions]);\n}\n","import type {TS} from \"../../../type/type.js\";\nimport {visitRootBlockSourceFile} from \"./visit-root-block-source-file.js\";\nimport type {AfterVisitorOptions} from \"../after-visitor-options.js\";\nimport {visitRootBlockBlock} from \"./visit-root-block-block.js\";\nimport {visitDefineArrayLiteralExpression} from \"./visit-define-array-literal-expression.js\";\n\nexport function visitNode<T extends TS.Node>(options: AfterVisitorOptions<T>): TS.VisitResult<TS.Node> {\n\tconst {\n\t\tnode,\n\t\tchildContinuation,\n\t\tdefineArrayLiteralExpression,\n\t\trootBlock,\n\t\tcontext: {typescript}\n\t} = options;\n\tif (typescript.isSourceFile(node) && rootBlock === node) {\n\t\treturn visitRootBlockSourceFile({...options, node});\n\t} else if (typescript.isBlock(node) && rootBlock === node) {\n\t\treturn visitRootBlockBlock({...options, node});\n\t} else if (typescript.isArrayLiteralExpression(node) && defineArrayLiteralExpression === node) {\n\t\treturn visitDefineArrayLiteralExpression({\n\t\t\t...options,\n\t\t\tnode\n\t\t});\n\t}\n\n\treturn childContinuation(options.node);\n}\n","import type {BaseVisitorContext, VisitorContext} from \"../visitor-context.js\";\nimport type {TS} from \"../../type/type.js\";\nimport type {AfterVisitorOptions} from \"./after-visitor-options.js\";\nimport {visitNode} from \"./visitor/visit-node.js\";\nimport {getDefineArrayLiteralExpression, getRootBlock} from \"../../util/ts-util.js\";\nimport {ensureNodeFactory} from \"compatfactory\";\n\ntype SourceFileWithEmitNodes = TS.SourceFile & {\n\temitNode?: {\n\t\thelpers?: TS.EmitHelper[];\n\t};\n};\n\nexport function afterTransformer(context: BaseVisitorContext): TS.TransformerFactory<TS.SourceFile> {\n\treturn transformationContext => {\n\t\tconst factory = ensureNodeFactory(transformationContext.factory ?? context.typescript);\n\n\t\treturn sourceFile =>\n\t\t\ttransformSourceFile(sourceFile, {\n\t\t\t\t...context,\n\t\t\t\ttransformationContext,\n\t\t\t\tfactory\n\t\t\t});\n\t};\n}\n\nfunction transformSourceFile(sourceFile: SourceFileWithEmitNodes, context: VisitorContext): TS.SourceFile {\n\t// For TypeScript versions below 3.5, there may be instances\n\t// where EmitHelpers such as __importDefault or __importStar is duplicated.\n\t// For these TypeScript versions, well have to guard against this behavior\n\tif (sourceFile.emitNode != null && sourceFile.emitNode.helpers != null) {\n\t\tconst seenNames = new Set();\n\t\tconst filtered = sourceFile.emitNode.helpers.filter(helper => {\n\t\t\tif (seenNames.has(helper.name)) return false;\n\t\t\tseenNames.add(helper.name);\n\t\t\treturn true;\n\t\t});\n\n\t\t// Reassign the emitNodes if they changed\n\t\tif (filtered.length !== sourceFile.emitNode.helpers.length) {\n\t\t\tsourceFile.emitNode.helpers = filtered;\n\t\t}\n\t}\n\n\tconst visitorOptions: Omit<AfterVisitorOptions<TS.Node>, \"node\" | \"sourceFile\"> = {\n\t\tcontext,\n\t\tdefineArrayLiteralExpression: getDefineArrayLiteralExpression(sourceFile, context),\n\t\trootBlock: getRootBlock(sourceFile, context),\n\n\t\tcontinuation: node =>\n\t\t\tvisitNode({\n\t\t\t\t...visitorOptions,\n\t\t\t\tsourceFile,\n\t\t\t\tnode\n\t\t\t}),\n\t\tchildContinuation: node =>\n\t\t\tcontext.typescript.visitEachChild(\n\t\t\t\tnode,\n\t\t\t\tcbNode =>\n\t\t\t\t\tvisitNode({\n\t\t\t\t\t\t...visitorOptions,\n\t\t\t\t\t\tsourceFile,\n\t\t\t\t\t\tnode: cbNode\n\t\t\t\t\t}),\n\t\t\t\tcontext.transformationContext\n\t\t\t)\n\t};\n\n\treturn visitorOptions.continuation(sourceFile) as TS.SourceFile;\n}\n","/* eslint-disable @typescript-eslint/naming-convention */\nimport type {DiOptions} from \"./di-options.js\";\nimport type {BaseVisitorContext} from \"./visitor-context.js\";\nimport {evaluate} from \"ts-evaluator\";\nimport TSModule from \"typescript\";\nimport {DI_CONTAINER_NAME} from \"./constant.js\";\nimport {needsImportPreservationLogic} from \"../util/ts-util.js\";\nimport type {TS} from \"../type/type.js\";\n\n/**\n * Shim the @wessberg/di module\n */\nconst EVALUATE_MODULE_OVERRIDES = {\n\t\"@wessberg/di\": {\n\t\t[DI_CONTAINER_NAME]: class {}\n\t}\n};\n\nexport function getBaseVisitorContext({typescript = TSModule as typeof TS, ...rest}: DiOptions = {}): BaseVisitorContext {\n\t// Prepare a VisitorContext\n\tconst visitorContextShared = {\n\t\tsourceFileToAddTslibDefinition: new Map(),\n\t\tsourceFileToRequiredImportedSymbolSet: new Map()\n\t};\n\n\tif (\"program\" in rest) {\n\t\tconst typeChecker = rest.program.getTypeChecker();\n\t\tconst compilerOptions = rest.program.getCompilerOptions();\n\t\treturn {\n\t\t\t...rest,\n\t\t\t...visitorContextShared,\n\t\t\tneedsImportPreservationLogic: needsImportPreservationLogic(typescript, compilerOptions),\n\t\t\ttypescript,\n\t\t\ttypeChecker,\n\t\t\tcompilerOptions,\n\n\t\t\tevaluate: node =>\n\t\t\t\tevaluate({\n\t\t\t\t\tnode,\n\t\t\t\t\ttypeChecker,\n\t\t\t\t\ttypescript,\n\t\t\t\t\tmoduleOverrides: EVALUATE_MODULE_OVERRIDES\n\t\t\t\t})\n\t\t};\n\t} else {\n\t\tconst compilerOptions = rest.compilerOptions ?? typescript.getDefaultCompilerOptions();\n\t\treturn {\n\t\t\tidentifier: [],\n\n\t\t\t...rest,\n\t\t\t...visitorContextShared,\n\t\t\tneedsImportPreservationLogic: needsImportPreservationLogic(typescript, compilerOptions),\n\t\t\ttypescript,\n\t\t\tcompilerOptions,\n\n\t\t\tevaluate: node =>\n\t\t\t\tevaluate({\n\t\t\t\t\tnode,\n\t\t\t\t\ttypescript,\n\t\t\t\t\tmoduleOverrides: EVALUATE_MODULE_OVERRIDES\n\t\t\t\t})\n\t\t};\n\t}\n}\n","import type {TS} from \"../type/type.js\";\nimport type {DiOptions} from \"./di-options.js\";\nimport {beforeTransformer} from \"./before/before-transformer.js\";\nimport {afterTransformer} from \"./after/after-transformer.js\";\nimport {getBaseVisitorContext} from \"./get-base-visitor-context.js\";\n\n/**\n * CustomTransformer that associates constructor arguments with any given class declaration\n */\nexport function di(options: DiOptions): TS.CustomTransformers {\n\tconst baseVisitorContext = getBaseVisitorContext(options);\n\n\treturn {\n\t\tbefore: [beforeTransformer(baseVisitorContext)],\n\t\tafter: baseVisitorContext.needsImportPreservationLogic ? [afterTransformer(baseVisitorContext)] : []\n\t};\n}\n","import path from \"crosspath\";\nimport {getBaseVisitorContext} from \"./get-base-visitor-context.js\";\nimport type {TransformOptions, TransformResult} from \"./transform-options.js\";\nimport {ensureArray, sha1} from \"../util/util.js\";\nimport type {BaseVisitorContext} from \"./visitor-context.js\";\nimport type {TSEmitHost, TSExtended, TSExtendedPrinter, TSSourceMapGenerator, TSSourceMapGeneratorOptions} from \"../type/type.js\";\nimport {ensureNodeFactory} from \"compatfactory\";\nimport {transformSourceFile} from \"./before/before-transformer.js\";\n\n/**\n * CustomTransformer that associates constructor arguments with any given class declaration\n */\nexport function transform(source: string, options?: TransformOptions): TransformResult;\nexport function transform(source: string, filename: string, options?: TransformOptions): TransformResult;\nexport function transform(source: string, filenameOrOptions: string | TransformOptions | undefined, optionsOrUndefined?: TransformOptions): TransformResult {\n\tconst filename = typeof filenameOrOptions === \"string\" ? filenameOrOptions : \"file.ts\";\n\tconst options = typeof filenameOrOptions === \"string\" ? optionsOrUndefined : filenameOrOptions;\n\n\tconst baseVisitorContext = getBaseVisitorContext(options);\n\n\t// By preserving value imports, we can avoid the `after` transformer entirely,\n\t// as well as adding/tracking imports,since nothing will be stripped away.\n\tbaseVisitorContext.compilerOptions.preserveValueImports = true;\n\n\tconst {compilerOptions} = baseVisitorContext;\n\tconst typescript = baseVisitorContext.typescript as TSExtended;\n\n\tconst hash = generateCacheKey(source, baseVisitorContext, options);\n\tconst cacheHit = hash == null ? undefined : options?.cache?.get(hash);\n\n\tif (cacheHit != null) {\n\t\treturn cacheHit;\n\t}\n\n\tconst newLine = typescript.sys.newLine;\n\tconst printer = (options?.printer ?? typescript.createPrinter()) as TSExtendedPrinter;\n\tconst factory = ensureNodeFactory(typescript);\n\n\t// An undocumented internal helper can be leveraged here\n\tconst transformationContext = typescript.nullTransformationContext;\n\tconst visitorContext = {...baseVisitorContext, transformationContext, factory};\n\n\tconst sourceFile = typescript.createSourceFile(filename, source, typescript.ScriptTarget.ESNext, true);\n\tconst transformedSourceFile = transformSourceFile(sourceFile, visitorContext);\n\n\tlet result: TransformResult;\n\n\tif (Boolean(compilerOptions.sourceMap)) {\n\t\tconst sourceMapOptions: TSSourceMapGeneratorOptions = {\n\t\t\tsourceMap: Boolean(compilerOptions.sourceMap),\n\t\t\tsourceRoot: \"\",\n\t\t\tmapRoot: \"\",\n\t\t\textendedDiagnostics: false\n\t\t};\n\n\t\tconst emitHost: TSEmitHost = {\n\t\t\tgetCanonicalFileName: typescript.createGetCanonicalFileName(typescript.sys.useCaseSensitiveFileNames),\n\t\t\tgetCompilerOptions: () => compilerOptions,\n\t\t\tgetCurrentDirectory: () => path.dirname(filename)\n\t\t};\n\n\t\tconst sourceMapGenerator = typescript.createSourceMapGenerator(emitHost, path.basename(filename), sourceMapOptions.sourceRoot, path.dirname(filename), sourceMapOptions);\n\t\tconst writer = typescript.createTextWriter(newLine);\n\t\tprinter.writeFile(transformedSourceFile, writer, sourceMapGenerator);\n\n\t\tconst sourceMappingUrl = getSourceMappingUrl(sourceMapGenerator, filename, Boolean(compilerOptions.inlineSourceMap));\n\t\tif (sourceMappingUrl.length > 0) {\n\t\t\tif (!writer.isAtStartOfLine()) writer.rawWrite(newLine);\n\t\t\twriter.writeComment(\"//# \".concat(\"sourceMappingURL\", \"=\").concat(sourceMappingUrl)); // Tools can sometimes see this line as a source mapping url comment\n\t\t}\n\n\t\tresult = {\n\t\t\tcode: writer.getText(),\n\t\t\tmap: Boolean(compilerOptions.inlineSourceMap) ? undefined : sourceMapGenerator.toString()\n\t\t};\n\t} else {\n\t\tresult = {\n\t\t\tcode: printer.printFile(transformedSourceFile)\n\t\t};\n\t}\n\n\tif (hash != null && options?.cache != null) {\n\t\toptions.cache.set(hash, result);\n\t}\n\n\treturn result;\n}\n\nfunction generateCacheKey(source: string, context: BaseVisitorContext, options: TransformOptions | undefined): string | undefined {\n\t// No point in calculating a hash if there's no cache in use\n\tif (options?.cache == null) return undefined;\n\n\tconst identifier = options != null && \"identifier\" in options ? options.identifier : undefined;\n\tlet key = source;\n\tif (identifier != null) {\n\t\tkey += ensureArray(identifier).join(\",\");\n\t}\n\n\tkey += Boolean(context.compilerOptions.sourceMap);\n\treturn sha1(key);\n}\n\nfunction getSourceMappingUrl(sourceMapGenerator: TSSourceMapGenerator, filePath: string, inline: boolean) {\n\tif (inline) {\n\t\t// Encode the sourceMap into the sourceMap url\n\t\tconst sourceMapText = sourceMapGenerator.toString();\n\t\tconst base64SourceMapText = Buffer.from(sourceMapText).toString(\"base64\");\n\t\treturn \"data:application/json;base64,\".concat(base64SourceMapText);\n\t}\n\tconst sourceMapFilePath = `${filePath}.map`;\n\tconst sourceMapFile = path.basename(sourceMapFilePath);\n\n\treturn encodeURI(sourceMapFile);\n}\n","import fs from \"fs\";\nimport path from \"path\";\nimport os from \"os\";\nimport {NOOP} from \"../util/util.js\";\n\n/**\n * This implementation is very closely inspired by that found in https://github.com/esbuild-kit/core-utils.\n */\n\nconst DEFAULT_TTL_DAYS = 7;\nconst DEFAULT_TTL = 60 * 60 * 24 * DEFAULT_TTL_DAYS * 1000;\n\ninterface FileCacheEntry {\n\ttime: number;\n\tkey: string;\n\tfileName: string;\n}\n\ninterface FileCacheOptions {\n\tcacheName: string;\n\tttl: number;\n}\n\nexport class FileCache<T> extends Map<string, T> {\n\tprivate readonly cacheFiles: FileCacheEntry[] = [];\n\tprivate readonly options: FileCacheOptions;\n\n\tconstructor({cacheName = \"di-compiler\", ttl = DEFAULT_TTL}: Partial<FileCacheOptions> = {}) {\n\t\tsuper();\n\n\t\tthis.options = {cacheName, ttl};\n\n\t\t// Initialize the disk cache\n\t\tfs.mkdirSync(this.cacheDirectory, {recursive: true});\n\t\tthis.cacheFiles = fs.readdirSync(this.cacheDirectory).map(fileName => {\n\t\t\tconst [time, key] = fileName.split(\"-\");\n\t\t\treturn {\n\t\t\t\ttime: Number(time),\n\t\t\t\tkey,\n\t\t\t\tfileName\n\t\t\t};\n\t\t});\n\n\t\tsetImmediate(() => this.expireDiskCache());\n\t}\n\n\tprivate get cacheDirectory() {\n\t\treturn path.join(os.tmpdir(), this.options.cacheName);\n\t}\n\n\tprivate readTransformResult(filePath: string): T | undefined {\n\t\ttry {\n\t\t\tconst jsonString = fs.readFileSync(filePath, \"utf8\");\n\t\t\treturn JSON.parse(jsonString) as T;\n\t\t} catch {\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tget(key: string) {\n\t\tconst memoryCacheHit = super.get(key);\n\n\t\tif (memoryCacheHit != null) {\n\t\t\treturn memoryCacheHit;\n\t\t}\n\n\t\tconst diskCacheHit = this.cacheFiles.find(cache => cache.key === key);\n\t\tif (diskCacheHit == null) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst cacheFilePath = path.join(this.cacheDirectory, diskCacheHit.fileName);\n\t\tconst cachedResult = this.readTransformResult(cacheFilePath);\n\n\t\tif (cachedResult == null) {\n\t\t\t// Remove broken cache file\n\t\t\tfs.promises.unlink(cacheFilePath).then(() => {\n\t\t\t\tconst index = this.cacheFiles.indexOf(diskCacheHit);\n\t\t\t\tthis.cacheFiles.splice(index, 1);\n\t\t\t}, NOOP);\n\t\t\treturn;\n\t\t}\n\n\t\t// Load it into memory\n\t\tsuper.set(key, cachedResult);\n\n\t\treturn cachedResult;\n\t}\n\n\tset(key: string, value: T) {\n\t\tsuper.set(key, value);\n\n\t\tif (value != null) {\n\t\t\tconst time = Date.now();\n\n\t\t\tfs.promises.writeFile(path.join(this.cacheDirectory, `${time}-${key}`), JSON.stringify(value)).catch(NOOP);\n\t\t}\n\n\t\treturn this;\n\t}\n\n\texpireDiskCache() {\n\t\tconst time = Date.now();\n\n\t\tfor (const cache of this.cacheFiles) {\n\t\t\t// Remove if older than ~7 days\n\t\t\tif (time - cache.time > this.options.ttl) {\n\t\t\t\tfs.promises.unlink(path.join(this.cacheDirectory, cache.fileName)).catch(NOOP);\n\t\t\t}\n\t\t}\n\t}\n}\n"],"names":["visitNode","transformSourceFile","TSModule","path"],"mappings":"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"}